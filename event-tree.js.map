{"version":3,"file":"event-tree.js","sources":["../../../home/runner/work/stanza-test/stanza-test/stanzas/event-tree/index.js"],"sourcesContent":["import 'https://d3js.org/d3.v5.min.js';\n\n\nexport default async function eventTree(stanza, params) {\n  stanza.render({\n    template: 'stanza.html.hbs',\n    parameters: {\n      greeting: `Hello, ${params['say-to']}!`\n    }\n  });\n  // var width = stanza.root.querySelector(\"svg\").clientWidth;\n  // var height = stanza.root.querySelector(\"svg\").clientHeight;\n  var width = 400;\n  var height = 300;\n  var data = {\n    \"name\": \"A\",\n    \"children\": [\n      { \"name\": \"B\" },\n      {\n        \"name\": \"C\",\n        \"children\": [{ \"name\": \"D\" }, { \"name\": \"E\" }, { \"name\": \"F\" }]\n      },\n      { \"name\": \"G\" },\n      {\n        \"name\": \"H\",\n        \"children\": [{ \"name\": \"I\" }, { \"name\": \"J\" }]\n      },\n      { \"name\": \"K\" }\n    ]\n  };\n\n  // 3. 描画用のデータ変換\n  var root = d3.hierarchy(data);\n  var tree = d3.tree()\n    .size([height, width - 160])\n  //  .nodeSize([50,300]) ;\n  //  .separation(function(a, b) { return(a.parent == b.parent ? 1 : 2); });\n\n  tree(root);\n\n  // 4. svg要素の配置\n  var chartElement = stanza.root.querySelector('#chart');\n  var svg = d3\n    .select(chartElement)\n    .append(\"svg\")\n    .attr(\"width\", width)\n    .attr(\"height\", height);\n  var g = svg.append(\"g\").attr(\"transform\", \"translate(80,0)\");;\n\n  var link = g\n    .selectAll(\".link\")\n    .data(root.descendants().slice(1))\n    .enter()\n    .append(\"path\")\n    .attr(\"class\", \"link\")\n    .attr(\"d\", function (d) {\n      return \"M\" + d.y + \",\" + d.x +\n        \"C\" + (d.parent.y + 100) + \",\" + d.x +\n        \" \" + (d.parent.y + 100) + \",\" + d.parent.x +\n        \" \" + d.parent.y + \",\" + d.parent.x;\n    });\n\n  var node = g.selectAll(\".node\")\n    .data(root.descendants())\n    .enter()\n    .append(\"g\")\n    .attr(\"class\", \"node\")\n    .attr(\"transform\", function (d) { return \"translate(\" + d.y + \",\" + d.x + \")\"; })\n\n  node.append(\"circle\")\n    .attr(\"r\", 6)\n    .attr(\"fill\", \"#999\");\n\n  node.append(\"text\")\n    .attr(\"dy\", 3)\n    .attr(\"x\", function (d) { return d.children ? -12 : 12; })\n    .style(\"text-anchor\", function (d) { return d.children ? \"end\" : \"start\"; })\n    .attr(\"font-size\", \"80%\")\n    .text(function (d) { return d.data.name; });\n\n    stanza.host.dispatchEvent(\n      new CustomEvent(\"valueChanged\", { detail: { value: 42 } })\n  );\n}\n"],"names":[],"mappings":"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"}